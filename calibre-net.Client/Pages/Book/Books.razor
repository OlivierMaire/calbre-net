@page "/books"
@inject ApiClients.BookClient BookClient
@inject ApiClients.IdentityClient IdentityClient

@attribute [StreamRendering]
@attribute [Authorize]

<PageTitle>Books</PageTitle>
<MudText Typo="Typo.h3" GutterBottom="true">Books</MudText>

@if (BookList == null)
{
    <MudProgressCircular Color="Color.Default" Indeterminate="true" />
}
else
{

<MudContainer Class="d-flex flex-row gap-2 flex-wrap flex-wrap-anim" MaxWidth="MaxWidth.False">
        @foreach (var book in BookList)
        {
            <BookThumb CalibreBook="@book"/>
        }
</MudContainer>

   
}


@code {

    ICollection<BookDto> BookList { get; set; } = null!;

    protected override async Task OnInitializedAsync()
    {
        @* await IdentityClient.DownloadPersonalDataAsync(); *@
        BookList = await BookClient.AllAsync();
        Console.WriteLine($"{BookList?.Count} books found");
        StateHasChanged();
    }
}